<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <script>
        const _toString = Object.prototype.toString;
        const isType = (value, type) => _toString.call(value) === '[object ' + type + ']';

        const isNull = value => isType(value, 'Null');
        const isUndefined = value => isType(value, 'Undefined');

        // string
        function trim(value) {
            if (String.prototype.trim) return value.trim();
            return value.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, '');
        }
        const isString = value => isType(value, 'String');
        const isValidString = value => isString(value) && trim(value).length > 0;
        const isEmptyString = value => isString(value) && trim(value).length === 0;

        // boolean
        const isBoolean = value => isType(value, 'Boolean');
        const isTure = value => isBoolean(value) && value === true;
        const isFalse = value => isBoolean(value) && value === false;

        // number
        const maxNumber = Math.pow(2, 53) - 1;
        const isNumber = value => isType(value, 'Number');
        const isValidNumber = value => isNumber(value) && isFinite(value) && value < maxNumber && value > -maxNumber;

        // function
        const isAsyncFunction = value => isType(value, 'AsyncFunction');
        const isFunction = value => isType(value, 'Function') || isAsyncFunction(value);

        // array
        const isArray = value => isType(value, 'Array');
        const isArrayBuffer = value => isType(value, 'ArrayBuffer');
        const isValidArray = value => isArray(value) && value.length > 0;
        const isEmptyArray = value => isArray(value) && value.length === 0;

        // object
        const isObject = value => isType(value, 'Object');
        const isValidObject = value => isObject(value) && Object.keys(value).length > 0;
        const isEmptyObejct = value => isObject(value) && Object.keys(value).length === 0;

        // date
        const isDate = value => isType(value, 'Date');
        // error
        const isError = value => isType(value, 'Error');
        //map
        const isMap = value => isType(value, 'Map');
        //set
        const isSet = value => isType(value, 'Set');
        //promise
        const isPromise = value => isType(value, 'Promise');
        //symbol
        const isSymbol = value => isType(value, 'Symbol');
        // weakMap
        const isWeakMap = value => isType(value, 'WeakMap');
        // weakSet
        const isWeakSet = value => isType(value, 'WeakSet');



        const defaultUndefined = undefined;
        const defaultString = "";
        const defaultNumber = 0;
        const defaultBoolean = false;
        const defaultObject = {};
        const defaultArray = [];
        const defaultFunction = function () { };
        const defaultGetVal = value => value;
        const matchPropName = /[^.\[\]]+/g;
        const isDeepKey = key => isString(key) && /[\.\[\]]+/g.test(key);


        function getDeepValue(obj, key) {
            const keys = key.match(matchPropName) || [];
            let value = obj;
            while (keys.length) {
                value = getSingleValue(value, keys.shift());
            }
            return value;
        }

        function getSingleValue(obj, key) {
            if( isObject(obj) || isArray(obj) ) return obj[key];
        }

        function getValue(obj, key, defaultValue, isType, getVal = defaultGetVal) {
            if (isArray(key)) return key.map(k => getValue(obj, k, defaultValue, isType, getVal));
            const value = isDeepKey(key) ? getDeepValue(obj, key) : getSingleValue(obj, key);
            return isType(value) ? getVal(value) : defaultValue;
        }

        function getString(obj, key, defaultValue = defaultString) {
            const _isString = value => isString(value) || isNumber(value) || isBoolean(value);
            return getValue(obj, key, defaultValue, _isString, value => String(value));
        }

        function getNumber(obj, key, defaultValue = defaultNumber) {
            const _isNumber = value => isFinite(Number(value));
            return getValue(obj, key, defaultValue, _isNumber, value => Number(value));
        }

        function getBoolean(obj, key, defaultValue = defaultBoolean) {
            const _isBoolean = value => {
                if (isString(value)) value = value.toLowerCase();
                return (
                    isBoolean(value) ||
                    value === 0 ||
                    value === 1 ||
                    value === "false" ||
                    value === "true"
                );
            };
            return getValue(obj, key, defaultValue, _isBoolean, value => Boolean(value));
        }

        function getObject(obj, key, defaultValue = defaultObject) {
            return getValue(obj, key, defaultValue, isObject);
        }

        function getArray(obj, key, defaultValue = defaultArray) {
            return getValue(obj, key, defaultValue, isArray);
        }

        function getFunction(obj, key, defaultValue = defaultFunction) {
            return getValue(obj, key, defaultValue, isFunction);
        }

        function getAny(obj, key) {
            return getValue(obj, key, defaultUndefined, () => true);
        }

        // console.log(getString({ child: { name: "hello" } }, 'child.name'))
        console.log(getString({ child: { name: "hello" } }, 'child[name][1]'))
        // console.log(getString({ child: { name: "hello", arr:['1',2] } }, 'child[arr--1][0]'))



    </script>
</body>

</html>